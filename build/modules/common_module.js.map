{"version":3,"sources":["../index.js"],"names":[],"mappings":"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","file":"common_module.js","sourcesContent":["import bean from \"bean\";\nimport zest from \"zest\";\nimport { Controller } from \"ng-harmony-core\";\nimport { Log, NotImplementedError, MissingBehaviourError, BehaviourError, StateTransitionError } from \"ng-harmony-log\";\nimport \"ng-harmony-decorator\";\n\nexport class EventedController extends Controller {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\n\t    this.constructor.EVENTS.forEach((behaviour) => {\n\t\t\tfor (let [i, el] of (behaviour.ev.selector ?\n\t\t\t\t\tzest(behaviour.ev.selector, this.$element[0]).entries() :\n\t\t\t\t\t[this.$element[0]].entries())) {\n\t\t\t\tthis._closurize((_key, _fn, _el, _i) => {\n\t\t\t\t\tlet __fn = (...args) => {\n\t\t\t\t\t\tif (_key.delegate) {\n\t\t\t\t\t\t\tlet nodes = zest(_key.delegate, this.$element[0].entries());\n\t\t\t\t\t\t\tnodes.forEach((node, $n) => {\n\t\t\t\t\t\t\t\tif (args[0].currentTarget.isEqualNode(node)) {\n\t\t\t\t\t\t\t\t\tthis.$scope.$n = $n;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._preEventedFunction(_key, args[0], _el, $n);\n\t\t\t\t\t\t_fn(_el, $n, ...args);\n\t\t\t\t\t\tthis._postEventedFunction(_key, args[0], _el, $n, _fn.name);\n\t\t\t\t\t}\n\t\t\t\t\tbean.on(_el, behaviour.ev.type, behaviour.ev.delegate || __fn, behaviour.ev.delegate ? __fn : null);\n\t\t\t\t}, this, behaviour.ev, this[behaviour.fn], el, i);\n\t\t\t\tthis._digest();\n\t\t\t}\n\t\t});\n\t}\n\t_preEventedFunction (descriptor, ev, el, $n) {\n        if (!this._isVoid(descriptor.delegate)) {\n\t\t\tlet el = ev.currentTarget.parentNode;\n\t\t\twhile (!zest.matches(el, descriptor.delegate)) { el = el.parentNode; }\n\t\t\tlet list = Array.prototype.slice.call(el.parentNode.children);\n\t\t\tthis.$scope.n = list.indexOf(el);\n\t\t} else {\n\t\t\tlet el = ev.currentTarget;\n\t\t\tlet list = Array.prototype.slice.call(el.parentNode.children);\n\t\t\tthis.$scope.n = list.indexOf(el);\n\t\t}\n\t}\n\t_postEventedFunction (descriptor, ev, el, $n, triggerFn) {\n\t\tthis._emit(triggerFn, descriptor, { ev, el, $n });\n\t}\n\t_emit (triggerFn, descriptor, opts) {\n\t\tthis.$scope.$emit(\"change\", {\n\t\t\tscope: this,\n\t\t\ttriggerFn: triggerFn,\n\t\t\ttriggerTokens: descriptor,\n\t\t\tev: opts.ev,\n\t\t\tel: opts.el,\n\t\t\t$n: opts.$n\n\t\t});\n\t}\n}\nEventedController.$inject = [\"$element\", \"$timeout\"];"]}