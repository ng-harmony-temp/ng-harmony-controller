{"version":3,"sources":["../index.js"],"names":[],"mappings":"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","file":"umd_module.js","sourcesContent":["import bean from \"bean\";\nimport zest from \"zest\";\nimport { Controller } from \"ng-harmony-core\";\nimport { Log, NotImplementedError, MissingBehaviourError, BehaviourError, StateTransitionError } from \"ng-harmony-log\";\nimport \"ng-harmony-decorator\";\n\nexport class EventedController extends Controller {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\n\t    this.constructor.EVENTS.forEach((behaviour) => {\n\t\t\tfor (let [i, el] of (behaviour.ev.selector ?\n\t\t\t\t\tzest(behaviour.ev.selector, this.$element.context).entries() :\n\t\t\t\t\t[this.$element.context].entries())) {\n\t\t\t\tthis._closurize((_key, _fn, _el, _i) => {\n\t\t\t\t\tlet __fn = (...args) => {\n\t\t\t\t\t\tthis._preEventedFunction(behaviour.ev, args[0], _el, _i);\n\t\t\t\t\t\t_fn(_el, _i, ...args);\n\t\t\t\t\t\tthis._postEventedFunction(_key, _fn, _el, _i, behaviour.ev);\n\t\t\t\t\t}\n\t\t\t\t\tbean.on(_el, behaviour.ev.type, behaviour.ev.delegate || __fn, behaviour.ev.delegate ? __fn : null);\n\t\t\t\t}, this, behaviour.ev, this[behaviour.fn].bind(this), el, i);\n\t\t\t\tthis._digest();\n\t\t\t}\n\t\t});\n\t}\n\t_preEventedFunction (descriptor, ev, ...args) {\n        if (!this._isVoid(descriptor.delegate)) {\n\t\t\tlet el = ev.currentTarget.parentNode;\n\t\t\twhile (!zest.matches(el, descriptor.delegate)) { el = el.parentNode; }\n\t\t\tlet list = Array.prototype.slice.call(el.parentNode.children);\n\t\t\tthis.$scope.n = list.indexOf(el);\n\t\t} else {\n\t\t\tlet el = ev.currentTarget;\n\t\t\tlet list = Array.prototype.slice.call(el.parentNode.children);\n\t\t\tthis.$scope.n = list.indexOf(el);\n\t\t}\n\t}\n\t_postEventedFunction (key, fn, el, i, descriptor) {\n        if (this.log) {\n            this.log({\n                level: \"info\",\n                msg: \"Method _\" + key + \"_ was triggered\"\n            })\n        }\n\t\tthis._emit(key, descriptor);\n\t}\n\t_emit (triggerFn, descriptor) {\n\t\tthis.$scope.$emit(\"change\", {\n\t\t\tscope: this,\n\t\t\ttriggerFn: triggerFn,\n\t\t\ttriggerTokens: descriptor\n\t\t});\n\t}\n}\nEventedController.$inject = [\"$element\", \"$timeout\"];"]}